# Security & Invariants

## Инварианты
- telegramUserId является главной идентичностью пользователя
- initData Telegram должен валидироваться
- один walletAddress привязан к одному telegramUserId
- оплата должна быть идемпотентной (повторная обработка не создаёт дублей)
- статусы платежей конечные: success/failed/expired

## Минимальные меры
- не хранить секреты в localStorage
- не хранить приватные ключи нигде (только TON Connect)
- все важные действия подтверждать статусами (pending → success)

## Антидубликаты
- защита от повторной отправки формы
- защита от повторной инициации оплаты
